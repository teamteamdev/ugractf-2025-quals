# Вещает, видимо: Write-up

В задании говорится о том, что кто-то кому-то что-то _вещает_.

Откроем файл. Почти все виды трафика, который там есть, какие-то неадекватные: битые TCP-сессии и невозможные DNS-запросы. Большую часть дампа занимает UDP-трафик с адреса 239.1.66.6, поступающий постоянно и равномерно. Адреса из подсети 239.0.0.0/8 — это multicast-адреса, используемые для массового вещания в интернете — там вполне может быть и наш _вещатель_.

Сохраним весь этот поток в файл — для этого нажмём на любой из пакетов правой кнопкой и выберем _Follow_ → _UDP Stream_. Внизу окна надо обязательно выбрать _Show data as_: _Raw_ — иначе файл сохранится с точками вместо непечатных символов. Сохраним файл — назовём его, например, `udpdump.bin`.

Попробуем понять, что там.

```bash
$ binwalk udpdump.bin 

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
548           0x224           MPEG transport stream data
1676          0x68C           MPEG transport stream data
3180          0xC6C           MPEG transport stream data
5248          0x1480          MPEG transport stream data
6564          0x19A4          MPEG transport stream data
8256          0x2040          MPEG transport stream data
9572          0x2564          MPEG transport stream data
10700         0x29CC          MPEG transport stream data
11828         0x2E34          MPEG transport stream data
13332         0x3414          MPEG transport stream data
14272         0x37C0          MPEG transport stream data
15588         0x3CE4          MPEG transport stream data
...
```

Вот и нашли то место, где нам _вещают_.

Поведение видеоплееров при виде этого файла различается. Так, _mpv_ вопроизводит видео так, как оно должно выглядеть, но не позволяет перематывать (потому что там битые метки времени). _VLC_ и _ffplay_ показывают первые кадры нормально, а остальные — бесконечно быстро. Вероятно, какие-то плееры просто отказываются воспринимать файл.

Чтобы получить из этого нормальный видеофайл, можно выполнить конвертацию с переопределением частоты кадров входного потока (тогда метки времени будут сгенерированы заново, в соответствии с порядком кадров в файле):

```bash
$ ffmpeg -r 25 -i udpdump.bin -c:v copy udpdump.mp4
```

Прогнорировав все ругательства про битые данные, можно уже полноценно [смотреть](writeup/udpdump.mp4), что получилось.

![Видео](writeup/udpdump.gif)

Флаг: **ugra_abrupt_and_furious_yet_braindead_yg3ltj2jg96gk**
